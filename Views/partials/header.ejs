<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClubReads</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/Public/style.css">
    <link rel="shortcut icon" type="image/x-icon" href="/public/images/favicon.ico"/>
    <script src="https://kit.fontawesome.com/6284428b3c.js" crossorigin="anonymous"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js'></script>
    <script>
        function openEventModal(selectedDate) {
          console.log(`Selected date: ${selectedDate}`);
          
          const createEvent = window.confirm(`No events on ${selectedDate}, would you like to create one?`);
          if (createEvent) {
            console.log('Creating new event');
            const eventTitle = prompt('Enter event title:');
            const eventStart = selectedDate;
            const eventEnd = prompt('Enter event end date (YYYY-MM-DD HH:mm):');
      
            if (eventTitle && eventEnd) {
              const eventData = {
                title: eventTitle,
                start: new Date(eventStart),
                end: new Date(eventEnd),
              };
      
              // Make an AJAX POST request to your server
              const bookclub = Club.findById(req.params._id)
              fetch(`/bookclubPage/${bookclub}/createEvent`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(eventData),
              })
                .then((response) => response.json())
                .then((data) => {
                  if (data.success) {
                    // Event created successfully, update the UI or calendar as needed
                    // You might want to reload the page or update the calendar to show the new event
                  } else {
                    // Handle error, show error message to user
                  }
                })
                .catch((error) => {
                  console.error('Error creating event:', error);
                });
            }
          }
        }
      
        document.addEventListener('DOMContentLoaded', function() {
          var calendarEl = document.getElementById('calendar');
          var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            selectable: true,
            events: [
              {
                title: 'The Title',
                start: '2018-09-01',
                startTime: '',
                end: '2018-09-02',
              },
            ],
            dateClick: function(info) {
              openEventModal(info.dateStr);
            },
          });
          calendar.render();
        });
      </script>
</head>
<header>
    <div class="nav navbar d-flex flex-row justify-content-between align-items-center text-center">
            <div class=""><!--flex-grow-1-->
                <h1 class="text-center pl-5" ><a  class="clubReads" href="/" style="color: white">ClubReads</a></h1>
            </div>

            <div>
                
            </div>
            <div>
        
            
                <% if(user){ %>
                    
                <a href="/profile" class=" float-end">  <img class="profPicMini" src="<%= user.profilePic%>" style="object-fit: fill;" ></a>
                <% } %>
                
            
            
                <a href="/bookclubs" class="btnMain btn-primary flex-end float-end"> View clubs</a>
            
                </div>
            
     
    </div>
</header>
